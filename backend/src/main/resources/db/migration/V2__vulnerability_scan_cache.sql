CREATE TABLE IF NOT EXISTS osv_vuln_cache (
  osv_id TEXT PRIMARY KEY,
  jsonb JSONB NOT NULL,
  fetched_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS nvd_cve_cache (
  cve_id TEXT PRIMARY KEY,
  jsonb JSONB NOT NULL,
  fetched_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);

CREATE TABLE IF NOT EXISTS dependency_scans (
  scan_id UUID PRIMARY KEY,
  input_hash TEXT UNIQUE NOT NULL,
  input_type TEXT NOT NULL,
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  result_jsonb JSONB NOT NULL
);
